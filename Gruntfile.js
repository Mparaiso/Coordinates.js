/****************************************************************************************************************************************************************
 *   Grunt File Usage:
 ****************************************************************************************************************************************************************
 *
 *  Export Documentation, TypeScript and Minify:
 *
 *      grunt
 *
 *  Export TypeScript and Minify:
 *
 *      grunt lib
 *
 *****************************************************************************************************************************************************************
 *  Options
 *****************************************************************************************************************************************************************
 *
 *  Export lib version, defaults to 'next' if not specified:
 *
 *      grunt --libversion=0.0.1
 *
 ****************************************************************************************************************************************************************
 *    Installing Dependencies:
 ****************************************************************************************************************************************************************
 *
 *  To install Grunt
 *
 *  1) install the grunt cli:
 *
 *      npm install -g grunt-cli
 *
 *  2) install the dependencies used by the build script:
 *
 *      OSX :       sudo npm install
 *      Windows:    npm install
 *
 ****************************************************************************************************************************************************************/

module.exports = function(grunt) {"use strict";
    var version = grunt.option('libversion') || 'next';
    // Check for a version number | defaults to next if not specified

    //--------------------------------------------------------------------------------------------------------------
    // Plugins used by Grunt Script
    //--------------------------------------------------------------------------------------------------------------

    grunt.loadNpmTasks("grunt-ts");

    //--------------------------------------------------------------------------------------------------------------
    // Grunt Config
    //--------------------------------------------------------------------------------------------------------------

    grunt.initConfig({

        //--------------------------------------------------------------------------------------------------------------
        // Read the package.json
        //--------------------------------------------------------------------------------------------------------------

        pkg : grunt.file.readJSON('package.json'),

        //--------------------------------------------------------------------------------------------------------------
        // Metadata / Configuration
        //--------------------------------------------------------------------------------------------------------------

        meta : {

             tsFile : 'src/Coordinate.ts', // TypeScript export source
            tsPath : 'src/', // TypeScript source folder

            tsExportFile : 'build/Coordinate.' + version + '.js', // JavaScript export target
            // tsExportUglyFile : 'build/Away3D.' + version + '.min.js', // JavaScript minified target

            tsExportFolder : 'build/', // Export folder
            docsPath : 'docs/' // Documentation export path

        },

        //--------------------------------------------------------------------------------------------------------------
        // Export and compile TypeScript
        //--------------------------------------------------------------------------------------------------------------

        ts : {

            MainJsFile : {
                src : ['<%= meta.tsFile %>'], out : '<%= meta.tsExportFile %>', options : {
                    target : 'es5', sourcemap : true, declaration : true, comments : true
                }
            }
        },

        //--------------------------------------------------------------------------------------------------------------
        // Concatenate file ( currently not used )
        //--------------------------------------------------------------------------------------------------------------

        concat : {
            options : {
                // define a string to put between each file in the concatenated output
                separator : ';'
            }, dist : {
                // the files to concatenate
                src : ['<%= meta.tsExportFile %>'],
                // the location of the resulting JS file
                dest : ''

            }
        }
    });

    //--------------------------------------------------------------------------------------------------------------
    // Register Grunt tasks
    //--------------------------------------------------------------------------------------------------------------

    grunt.option.init();
    grunt.registerTask('default', ['ts']);
    // Export TypeScript only
};
